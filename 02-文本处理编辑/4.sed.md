# sed

sed: Stream EDitor, 行编辑器

用法：

	sed [option]... 'script' inputfile...

		script: '地址+命令'

常用选项：

	-n：不输出模式中的内容至屏幕；
	-e: 多点编辑；
	-f /PATH/TO/SCRIPT_FILE: 从指定文件中读取编辑脚本；
	-r: 支持使用扩展正则表达式；
	-i: 原处编辑；

地址定界：

	(1) 不给地址：对全文进行处理；
	(2) 单地址：
		#: 指定的行；
		/pattern/：被此处模式所能够匹配到的每一行；
	(3) 地址范围：
		#,#
		#,+#
		/pat1/,/pat2/
		#,/pat1/
	(4) ~：步进
		1~2
		2~2

编辑命令：

    d: 删除
    p: 显示模式空间中的内容
    a \text：在行后面追加文本；支持使用\n实现多行追加；
    i \text：在行前面插入文本；支持使用\n实现多行插入；
    c \text：替换行为单行或多行文本；
    w /path/to/somefile: 保存模式空间匹配到的行至指定文件中；
    r /path/from/somefile：读取指定文件的文本流至模式空间中匹配到的行的行后；
    =: 为模式空间中的行打印行号；
    !: 取反条件;
    s///：支持使用其它分隔符，s@@@，s###；
    	替换标记：
    		g: 行内全局替换；
    		p: 显示替换成功的行；
    		w /PATH/TO/SOMEFILE：将替换成功的结果保存至指定文件中；


高级编辑命令：

	h: 把模式空间中的内容覆盖至保持空间中；
	H：把模式空间中的内容追加至保持空间中；
	g: 从保持空间取出数据覆盖至模式空间；
	G：从保持空间取出内容追加至模式空间；
	x: 把模式空间中的内容与保持空间中的内容进行互换；
	n: 读取匹配到的行的下一行至模式空间；
	N：追加匹配到的行的下一行至模式空间；
	d: 删除模式空间中的行；
	D：删除多行模式空间中的所有行；

	sed -n 'n;p' FILE：显示偶数行
	sed '1!G;h;$!d' FILE：逆向显示文件内容
	sed '$!N;$!D' FILE: 取出文件后两行；
	sed '$!d' FILE：取出文件最后一行；
	sed 'G' FILE:
	sed '/^$/d;G' FILE:
	sed 'n;d' FILE: 显示奇数行；
	sed -n '1!G;h;$p' FILE: 逆向显示文件中的每一行；
---
附：

练习1：删除/boot/grub/grub.conf文件中所有以空白开头的行行首的空白字符；

	~]# sed 's@^[[:space:]]\+@@' /etc/grub2.cfg

练习2：删除/etc/fstab文件中所有以#开头，后面至少跟一个空白字符的行的行首的#和空白字符；

	~]# sed 's@^#[[:space:]]\+@@' /etc/fstab

练习3：echo一个绝对路径给sed命令，取出其基名；取出其目录名；

	~]# echo "/etc/sysconfig/" | sed 's@[^/]\+/\?$@@'
